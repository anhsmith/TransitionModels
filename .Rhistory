data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=20) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .5) +
geom_point(data = d)
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=20) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .5) +
geom_point(data = d)
b_d |>
spread_draws(b_Intercept,b_x) |>
median_qi(p=rethinking::inv_logit(b_Intercept + ))
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=20) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .5) +
geom_point(data = d)
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=20) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .05) +
geom_point(data = d)
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=20) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=50) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
vignette('tidybayes')
rstan:::rstudio_stanc("model_d.stan")
stan_d <- stan_model(file = 'model_d.stan')
N_test <- 100
x_text <- seq(300,900,length=N_test)
datstan <- list(N = nrow(d),
x = d$x,
y = d$y,
prior_tr_mu=600,
prior_tr_sd=100,
prior_sigma_scale=50,
N_test=N_test,
x_test=x_test)
x_text <- seq(300,900,length=N_test)
datstan <- list(N = nrow(d),
x = d$x,
y = d$y,
prior_tr_mu=600,
prior_tr_sd=100,
prior_sigma_scale=50,
N_test=N_test,
x_test=x_test)
rm(x_text)
N_test <- 100
x_test <- seq(300,900,length=N_test)
datstan <- list(N = nrow(d),
x = d$x,
y = d$y,
prior_tr_mu=600,
prior_tr_sd=100,
prior_sigma_scale=50,
N_test=N_test,
x_test=x_test)
inits = list(list(transition=rnorm(1,mean=600,sd=50)))
fit_d <- sampling(stan_d, data = datstan,
init=inits, chains=1)
print(fit_d, pars = c("transition", "sigma"))
inits = list(list(transition=520),
list(transition=550),
list(transition=650),
list(transition=680))
fit_d <- sampling(stan_d, data = datstan,
init=inits, chains=4)
print(fit_d, pars = c("transition", "sigma"))
fit_d
??extract
fit_d <- spread_draws(p)
fit_d <- spread_draws("p")
fit_d <- spread_draws(p[i])
spread_draws(fit_d, p[i])
spread_draws(fit_d, x_test, p[i])
data.frame(x_test)
spread_draws(fit_d,
data.frame(x_test),
p[i])
data.frame(x_test)
spread_draws(fit_d,
# data.frame(x_test),
p[i])
gather_draws(fit_d,
# data.frame(x_test),
p[i])
spread_draws(fit_d,
# data.frame(x_test),
p[i])
spread_draws(fit_d,
# data.frame(x_test),
p[i],
n=20)
spread_draws(fit_d,
x_test,
p[i],
n=20)
p_d <- spread_draws(fit_d,
x_test,
p[i],
n=20)
p_d <- spread_draws(fit_d,
p[i],
n=20)
p_d <- spread_draws(fit_d,
p[i],
ndraws=20)
spread_draws(fit_d,
p[i],
ndraws=20)
fit_d@data
fit_d |> names
fit_d |> names()
str(fit_d)
rep(d$x_test, each=20)
d
rep(datstan$x_test, each=20)
spread_draws(fit_d,
p[i],
ndraws=20)
mutate(x = rep(datstan$x_test, each=20)
)
p_d <- spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = rep(datstan$x_test, each=20))
p_d <- spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i])
p_d
p_d <- spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
aes(x=x,y=p,group=i) +
geom_line()
p_d <- spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
aes(x=x,y=p,group=i) +
geom_line()
p_d
spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
aes(x=x,y=p,group=.draw) +
geom_line()
spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
aes(x=x,y=p,group=.draw) +
geom_line()
spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
aes(x=x,y=p,group=.draw) +
geom_line() +
geom_point(aes(x=x,y=y))
spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
aes(x=x,y=p,group=.draw) +
geom_line() +
geom_point(aes(x=x,y=y), data=d)
spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw)) +
geom_point(aes(x=x,y=y), data=d)
spread_draws(fit_d,
p[i],
ndraws=20) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw), alpha=.1) +
geom_point(aes(x=x,y=y), data=d, col=2)
spread_draws(fit_d,
p[i],
ndraws=50) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw), alpha=.1) +
geom_point(aes(x=x,y=y), data=d, col=2)
b_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=50) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
p_d
b_d
p_d <- spread_draws(fit_d,
p[i],
ndraws=50) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw), alpha=.1) +
geom_point(aes(x=x,y=y), data=d, col=2)
p_d
b_d
b_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=200) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
b_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=200) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
b_d
b_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=50) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
p_d
b_d
b_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=100) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=100) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .1) +
geom_point(data = d)
d
d |>
data_grid(x=seq_range(x,n=101))
d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=100)
d |>
data_grid(x=seq_range(x,n=101))
b_d <- brm(y~x, family=bernoulli, data = d)
p_d <- spread_draws(fit_d,
p[i],
ndraws=200) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw), alpha=.05) +
geom_point(aes(x=x,y=y), data=d, col=2)
pb_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=200) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .05) +
geom_point(data = d)
p_d
pb_d
pb_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=500) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .05) +
geom_point(data = d)
p_d <- spread_draws(fit_d,
p[i],
ndraws=500) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw), alpha=.05) +
geom_point(aes(x=x,y=y), data=d, col=2)
p_d
pb_d
pb_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=500) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .05) +
geom_point(data = d) +
geom_vline(xintercept=600)
p_d
pb_d
pb_d <- d |>
data_grid(x=seq_range(x,n=101)) |>
add_epred_draws(b_d, ndraws=500) |>
ggplot() +
aes(x = x, y = y) +
geom_line(aes(y = .epred, group=.draw), alpha = .05) +
geom_point(data = d) +
geom_vline(xintercept=600, col="white")
p_d
pb_d
p_d <- spread_draws(fit_d,
p[i],
ndraws=500) |>
mutate(x = x_test[i]) |>
ggplot() +
geom_line(aes(x=x,y=p,group=.draw), alpha=.05) +
geom_point(aes(x=x,y=y), data=d, col=2)+
geom_vline(xintercept=600, col="white")
p_d
pb_d
?case_when
d <- read_csv("Data/LHDC.csv")
library(tidyverse)
d <- read_csv("Data/LHDC.csv")
d
d |> group_by(Country, LS_Score)
d |> group_by(Country, LS_Score) |> summarise(n = n())
d |> group_by(Populatin, LS_Score) |> summarise(n = n())
d |> group_by(Population, LS_Score) |> summarise(n = n())
d |>
filter(LS_score != 2.3) |>
group_by(Population, LS_Score) |>
summarise(n = n())
d |>
filter(LS_Score != 2.3) |>
group_by(Population, LS_Score) |>
summarise(n = n())
d |>
filter(Population == "New Zealand") |>
ggplot() +
aes(x=TL, col = LS_Score) +
geom_density()
d |>
filter(Population == "New Zealand") |>
ggplot() +
aes(x=TL, colour=LS_Score) +
geom_density()
d |>
filter(Population == "New Zealand") |>
ggplot() +
aes(x=TL, colour=LS_Score, group=LS_Score) +
geom_density()
d |>
filter(Population == "New Zealand") |>
ggplot() +
aes(x=TL, colour=factor(LS_Score), group=LS_Score) +
geom_density()
d |>
filter(Population == "New Zealand" & LS_Score > 1) |>
ggplot() +
aes(x=TL, colour=factor(LS_Score), group=LS_Score) +
geom_density()
d |>
filter(Population == "New Zealand" & LS_Score > 1) |>
ggplot() +
aes(x=TL, colour=factor(LS_Score), group=LS_Score) +
geom_histogram()
d |>
filter(Population == "New Zealand" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram() +
facet_grid(rows=factor(LS_Score))
d |>
filter(Population == "New Zealand" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram() +
facet_grid(rows=LS_Score)
d |>
filter(Population == "New Zealand" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram() +
facet_grid(rows=vars(LS_Score))
d |>
filter(Population == "New Zealand" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_density()
d |>
filter(Population == "Australia" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_density()
d |>
filter(Population == "Northeast Atlantic" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_density()
d |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_density()
d |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_density()
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_density()
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_density(alpha = .3)
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_density(alpha = .3)
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram(alpha = .3)
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram(alpha = .3)+
facet_grid(rows=vars(LS_Score))
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram()+
facet_grid(rows=vars(LS_Score))
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=log(TL), fill=factor(LS_Score), group=LS_Score) +
geom_histogram()+
facet_grid(rows=vars(LS_Score))
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, fill=factor(LS_Score), group=LS_Score) +
geom_histogram()+
facet_grid(rows=vars(LS_Score))
d |>
filter(LS_Score != 2.3) |>
filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_histogram()
d |>
filter(LS_Score != 2.3) |>
# filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_histogram()
d |>
filter(LS_Score != 2.3) |>
# filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL) +
geom_histogram()+
facet_grid(rows=vars(LS_Score), cols = vars(Population))
d |>
filter(LS_Score != 2.3) |>
# filter(Population == "South Africa" & LS_Score > 1) |>
ggplot() +
aes(x=TL, y=after_stat(density)) +
geom_histogram()+
facet_grid(rows=vars(LS_Score), cols = vars(Population))
